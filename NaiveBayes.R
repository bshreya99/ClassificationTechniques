Sys.setenv(JAVA_HOME = "C:\\Program Files\\Java\\jre")
require(e1071)
library(dplyr)
library(caTools)
library(caret)
df = read.csv(file = "income.csv", header = TRUE, check.names = FALSE)
names(df)
df = select(df,'income', 'age', 'fnlwgt', 'education-num' , 'marital-status', 'occupation', 'capital-gain', 'capital-loss', 'hours-per-week')
sample = sample.split(df$income,SplitRatio = .85)
train = subset(df, sample == TRUE)
test = subset(df, sample == FALSE)
model = naiveBayes(income ~ ., data = train)
pred = predict(model, test, type = 'class' )
confusionMatrix(pred, test$income)
